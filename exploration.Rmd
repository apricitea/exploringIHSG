---
title: "Eksplorasi Data Adjusted Closing Price IHSG"
author: "Kelompok 14"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Anggota Kelompok
- G14190007 Dhiffa Fatihah Umami
- G14190026 Nenden Maulidia
- G14190043 Tony Alfan
- G14190047 Alvin Christian
- G14190071 Muhammad Hadyan Rizki

## IHSG
Indeks Harga Saham Gabungan (IHSG) merupakan catatan-catatan atas perubahan maupun pergerakan harga saham sejak mulai pertama kali beredar sampai pada suatu saat tertentu. Ada beberapa faktor yang mempengaruhi IHSG, salah satunya adalah faktor makroekonomi seperti tingkat inflasi, nilai tukar rupiah, tingkat suku bunga dan lain-lain (Krisna dan Wirawati 2013).

Indeks Harga Saham Gabungan (IHSG) merupakan suatu nilai untuk mengukur kinerja seluruh saham. IHSG mencerminkan perkembangan pasar secara keseluruhan. Jika IHSG mengalami kenaikan dari hari kemarin maka beberapa saham yang berada pada bursa efek mengalami kenaikan. Oleh karena itu, peramalan harga akan sangat bermanfaat untuk para investor sehingga mereka dapat mengetahui prospek investasi saham di masa yang akan datang (Afittia 2018).

Dataset yang akan digunakan merupakan dataset IHSG dari tanggal 1 Januari 1991 hingga 31 Desember 2020 dengan jumlah 10.598 amatan data.Karena ada banyak missing value, maka perlu dilakukan imputasi. Mengapa bisa ada missing value?

- Bursa Efek Indonesia tidak dibuka pada hari sabtu dan minggu
- Bursa Efek Indonesia tidak dibuka pada tanggal merah

Mengapa perlu dilakukan imputasi? Karena pada hari sabtu & minggu dan pada tanggal merah, masyarakat tetap dapat memiliki perubahan opini terhadap harga saham. Contohnya, perusahaan X terkena kasus pada hari sabtu, maka masyarakat akan cenderung memberikan harga lebih kecil terhadap saham perusahaan X sehingga ketika pasar saham dibuka, harga saham perusahaan X akan langsung menurun. Hal ini juga diperkuat fakta bahwa analisis time series memerlukan seluruh amatan secara lengkap.

Metode imputasi yang kami gunakan adalah dengan interpolasi linear. Hal ini dapat dilakukan di R dengan library “imputeTS” dengan function na_interpolation().

Importing libraries
```{r error=F, warning=F, message=F}
library(aTSA)
library(imputeTS)
library(knitr)
library(MASS)
```

Our first step would be to import the IHSG dataset and have a look at the first few data.
```{r error=F, warning=F, message=F}
ihsg <- read.csv("C:/Users/Haci/Desktop/Metode Peramalan Deret Waktu/Project-20220127/IHSG7days.csv", sep=";")
kable(ihsg[1:10,], caption="First 10 rows of IHSG daily prices")
```

From the first 10 rows of data, we can see that there are some missing values. We also knew that stock market doesn't open at weekends so more missing values. If we were to perform time series analysis on the daily prices of IHSG, the missing values should be imputed. We will do the imputation using Linear Interpolation. 

```{r error=F, warning=F, message=F}
ihsg.imputed <- na_interpolation(ihsg)
ggplot_na_imputations(ihsg$JKSE.Adjusted, ihsg.imputed$JKSE.Adjusted)
```

We can see that the imputation doesn't change the trend of the IHSG Adjusted Closing Price. Now let's see the full time series plot of daily Adjusted Closing Price of IHSG.

```{r error=F, warning=F, message=F}
ihsg.ts <- ts(ihsg.imputed$JKSE.Adjusted)
ts.plot(ihsg.ts, xlab="Time Period", ylab="IHSG Adjusted Closing Price", 
        main="IHSG Adjusted Closing Price Overtime")
```

Based on the time series plot, we can see that our data is not stationary. We can get a closer look through ACF and PACF plot.

```{r error=F, warning=F, message=F}
acf(ihsg.ts, lag.max = 50, main = "ACF IHSG Adjusted Closing Price") 
pacf(ihsg.ts, lag.max = 50, main = "PACF IHSG Adjusted Closing Price") 
adf.test(ihsg.ts)
```

ACF plot clearly shows that the ACF is decreassing exponentially. Thus, our data is not stationary. It is also confirmed by the ADF test that the IHSG adjusted closing price is not stationary. There are ways to solve this problem, but first we will try to differencing our data.

```{r}
ihsg.diff <- diff(ihsg.ts, difference=1)
ts.plot(ihsg.diff, xlab="Time Period", ylab="IHSG Adjusted Closing Price Difference", main="IHSG Adjusted Closing Price Difference Overtime")
```

From the time series plot, we can see that the data has become stationary in trend but not in variance. We can confirm this using ACF and PACF plots and perform ADF test.

```{r error=F, warning=F, message=F}
acf(ihsg.diff, lag.max = 50, main = "ACF IHSG Adjusted Closing Price") 
pacf(ihsg.diff, lag.max = 50, main = "PACF IHSG Adjusted Closing Price") 
adf.test(ihsg.ts)
```

Now ACF and PACF plot and the ADF test suggest that the difference of IHSG adjusted closing price is stationary. But we still need to solve the non-stationarity in variance. Our first attempt is by transforming data using several methods.

```{r error=F, warning=F, message=F}
ihsg.sqrt <- ihsg.diff^(1/2)
ihsg.cbrt <- ihsg.diff^(1/3)
ihsg.log <- log(ihsg.diff+abs(min(ihsg.diff)))
ihsg.inv <- -1/ihsg.diff

ts.plot(ihsg.sqrt)
ts.plot(ihsg.cbrt)
ts.plot(ihsg.log)
ts.plot(ihsg.inv)
```

```{r error=F, warning=F, message=F}
minvalue <- abs(min(ihsg.diff))+1
bcd <- boxcox((ihsg.diff+minvalue) ~ 1)
lambda <- bcd$x[which.max(bcd$y)]; lambda

ihsg.bc <- ihsg.diff^(lambda)
ts.plot(ihsg.bc)
```

None of those transformation succeed in solving our non-stationarity in variance. We've also tried Box Cox transformation but it doesn't succeed either. Further exploration is needed.